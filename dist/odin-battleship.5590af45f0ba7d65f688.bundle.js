!function(){"use strict";function e(e,r,t){for(var n=arguments.length,o=new Array(n>3?n-3:0),a=3;a<n;a++)o[a-3]=arguments[a];if("string"!=typeof e)throw TypeError("Missing 'tagName' of type 'string'!");var i=document.createElement(e);if(r&&(i.className=r),t&&(i.textContent=t),1===o.length&&Array.isArray(o[0])&&Array.isArray(o[0][0])&&(o=o.flat(1)),o.length>0)for(var l=0;l<o.length;l++){if(!Array.isArray(o[l])||2!==o[l].length||!o[l][0]||"string"!=typeof o[l][0])throw TypeError("A given attribute in '...attrs' must be in the form of [string, string]");(o[l][1]||0===o[l][1]||""===o[l][1])&&i.setAttribute(o[l][0],o[l][1])}return i}var r={};function t(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if("string"!=typeof e||!n.every((function(e){return"function"==typeof e}))){var a="".concat(e).concat(n.length>0?", "+n.toString().replace(/(?:\[|\])/,""):"");throw TypeError("Expect event name of type 'string' and at least 1 callback! Given: '".concat(a,"'"))}var i;r[e]?(i=r[e]).push.apply(i,n):r[e]=n}function n(e,t){if("string"!=typeof e||"function"!=typeof t)throw TypeError("Expect (eventName: string) & (callback: function)! Given: '".concat(e,", ").concat(t,"'"));r[e]&&(r[e]=r[e].filter((function(e){return e!==t})))}function o(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if("string"!=typeof e)throw TypeError("Expect at least 1 argument of type 'string'! Given: '".concat(e,"'"));r[e]&&r[e].forEach((function(e){e.apply(void 0,n)}))}Object.freeze(t),Object.freeze(t.prototype),Object.freeze(n),Object.freeze(n.prototype),Object.freeze(o),Object.freeze(o.prototype);var a={ATTACK:"Fire",HIT:"Boom",MISS:"Oops",LOSS:"Meh",GAME_OVER:"Bye",add:t,remove:n,emit:o};function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function l(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function c(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?l(Object(t),!0).forEach((function(r){var n,o,a,l;n=e,o=r,a=t[r],l=function(e,r){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o),(o="symbol"==i(l)?l:String(l))in n?Object.defineProperty(n,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[o]=a})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function u(e){if(!Number.isInteger(e)||e<2||e>5)throw TypeError("Expect 1 argument (length) of type 'number'; 1 < length < 6! given '".concat(e,"'"));var r=0,t=!1,n=function(){t||(r++,t=r>=e)},o=function(){return t},a={length:e,hits:r,hit:n,isSunk:o};Object.setPrototypeOf(a,u.prototype);var i={configurable:!1,enumerable:!0},l=c(c({},i),{},{writable:!1});return Object.defineProperties(a,{constructor:c(c({},l),{},{enumerable:!1,value:u}),length:c(c({},i),{},{get:function(){return e}}),hits:c(c({},i),{},{get:function(){return r}}),hit:c(c({},l),{},{value:n}),isSunk:c(c({},l),{},{value:o})}),a}function f(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;c=!1}else for(;!(c=(n=a.call(t)).done)&&(l.push(n.value),l.length!==r);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,r)||y(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,r){if(e){if("string"==typeof e)return p(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?p(e,r):void 0}}function p(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function s(){for(var e=[],r=0;r<10;r++){e[r]=[];for(var t=0;t<10;t++)e[r][t]={ship:null,attacked:!1,missed:!1}}var n=function(e){return Math.floor(Math.random()*e)},o=function(r){var t=f(r,2),n=t[0],o=t[1];return null===e[n][o].ship},i=function(e,r,t){for(var n=[],a=r,i=0;i<e.length;i++){if(!o(a))return[];n.push(function(e){if(Array.isArray(e))return p(e)}(l=a)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(l)||y(l)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a[t]++}var l;return n},l=!1,c=function(r){for(var t=[],o=0;0===t.length&&o<100;){o++;var a=n(2),c=0===a?1:0,u=Array(2);u[a]=n(10-r.length),u[c]=n(10),t=i(r,u,a)}l=o>=100,t.forEach((function(t){var n=f(t,2),o=n[0],a=n[1];e[o][a].ship=r}))},d=[u(2),u(3),u(3),u(4),u(5)];do{d.forEach(c)}while(l);var h={ships:d,board:e,receiveAttack:function(r){var t=f(r,2),n=t[0],o=t[1];if(n<0||o<0||n>9||o>9)throw TypeError("Invalid coordinates! It should be in the range from '[0, 0]' to '[".concat(9,", ").concat(9,"]', the given is '[").concat(o,", ").concat(o,"]'."));var i=e[n][o];i.ship&&!i.attacked?(i.ship.hit(),i.attacked=!0,a.emit(a.HIT,[n,o])):i.ship||i.missed||(i.missed=!0,a.emit(a.MISS,[n,o])),d.every((function(e){return e.isSunk()}))&&a.emit(a.LOSS)}};return Object.setPrototypeOf(h,s.prototype),Object.defineProperty(h,"constructor",{value:s,writable:!1,configurable:!1,enumerable:!1}),Object.freeze(h),h}function d(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,a,i,l=[],c=!0,u=!1;try{if(a=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;c=!1}else for(;!(c=(n=a.call(t)).done)&&(l.push(n.value),l.length!==r);c=!0);}catch(e){u=!0,o=e}finally{try{if(!c&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(u)throw o}}return l}}(e,r)||function(e,r){if(e){if("string"==typeof e)return h(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?h(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function m(e){if(void 0!==e&&e!==m.TYPES.COMPUTER&&e!==m.TYPES.HUMAN)throw TypeError("Invalid type! Only '".concat(m.TYPES.COMPUTER,"' & '").concat(m.TYPES.HUMAN,"' are the valid types. Given: '").concat(e,"'"));var r={type:void 0===e?m.TYPES.COMPUTER:e,gameBoard:s()};if(r.type===m.TYPES.COMPUTER){for(var t,n,o=r.gameBoard.board.length,i=null!==(t=null===(n=r.gameBoard.board[0])||void 0===n?void 0:n.length)&&void 0!==t?t:0,l=null,c=[],u=0;u<o;u++)for(var f=0;f<i;f++)c.push([u,f]);var y=null,p=null,h=!1;a.add(a.MISS,(function(){h&&(y=null,h=!1)})),a.add(a.HIT,(function(){var e,r;h&&(e=[],r=[],[[-1,0],[0,1],[1,0],[0,-1]].forEach((function(t,n){var a,u=[l[0]+t[0],l[1]+t[1]];(a=u)[0]>=0&&a[1]>=0&&a[0]<o&&a[1]<i&&c.some((function(e){var r=d(e,2),t=r[0],n=r[1];return t===a[0]&&n===a[1]}))?(e.push(u),r.push(n)):e.push(null)})),r.length>0?(null!==y&&r.includes(y)||(y=r[Math.floor(Math.random()*r.length)]),p=e[y]):(y=null,p=null),h=!1)})),r.play=function(){if(c.length>0){if(null===p){var e=Math.floor(Math.random()*c.length);l=c[e],c.splice(e,1)}else l=p,p=null,c.splice(c.findIndex((function(e){var r=d(e,2),t=r[0],n=r[1];return l[0]===t&&l[1]===n})),1);h=!0,a.emit(a.ATTACK,l)}else h=!1,a.emit(a.GAME_OVER)}}return Object.setPrototypeOf(r,m.prototype),Object.defineProperty(r,"constructor",{value:m,writable:!1,enumerable:!1,configurable:!1}),Object.freeze(r),r}function v(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(e){if("string"==typeof e)return b(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?b(e,r):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function g(){return{playersData:[{name:"first-player",player:m(m.TYPES.HUMAN),playerUI:e("div","first-player")},{name:"second-player",player:m(m.TYPES.COMPUTER),playerUI:e("div","second-player")}],currentPlayerIndex:0,allPlayersDisabled:!1,switchCurrentPlayer:function(){this.currentPlayerIndex=(this.currentPlayerIndex+1)%2},renderPlayerUI:function(r,t){var n=this.playersData[r],o=r===this.currentPlayerIndex,i=this.allPlayersDisabled||o,l=n.player.type===m.TYPES.COMPUTER&&!o&&!i;v(n.playerUI.children).forEach((function(e){return e.remove()})),n.playerUI.append(function(r,t){if("string"!=typeof r)throw TypeError("Invalid 'name' type; expected: 'string', given: '".concat(r,"'"));var n;if(t===m.TYPES.COMPUTER)n="COMPUTER";else{if(t!==m.TYPES.HUMAN)throw TypeError("Invalid player type!");n="YOU"}var o,a,i,l=e("div","".concat(r,"-info")),c=(o=r.replace("-"," "),i=(a=String(o)).length>1?a.slice(1):"",a.charAt(0).toLocaleUpperCase()+i),u=e("h3","player-name","".concat(c," (").concat(n,")"));return l.append(u),l}(n.name,n.player.type),function(r,t,n,o){if([r,t,n].forEach((function(e){if(void 0===e)throw TypeError("'Board' is called with an invalid number of arguments!")})),!(r instanceof s))throw TypeError("'Board' is called with invalid 'playerGameBoard'! Given '".concat(r,"'."));if("boolean"!=typeof t||"boolean"!=typeof n)throw TypeError("'Board' expects 'hidden' & 'disabled' of type 'boolean'! Given '".concat(t," & ").concat(n,"'."));var i=e("div","board-container"+(n?" disabled":"")),l=0;return r.board.forEach((function(r,n){l=r.length,r.forEach((function(r,l){var c="board-cell";r.ship?(t||(c+=" ship"),r.ship.isSunk()?c+=" sunk":r.attacked&&(c+=" attacked")):r.missed&&(c+=" missed");var u=e("div",c);o&&u.addEventListener("click",(function(){a.emit(a.ATTACK,[n,l])})),i.appendChild(u)}))})),i.style.display="grid",i.style.gridTemplateColumns="repeat(".concat(l,", 1fr)"),i.style.gridTemplateRows="repeat(".concat(l,", auto)"),i}(n.player.gameBoard,n.player.type===m.TYPES.COMPUTER,i,l)),t&&t.append(n.playerUI)},renderAllPlayersUI:function(e){for(var r=0;r<this.playersData.length;r++)this.renderPlayerUI(r,e)},playIfComputerTurn:function(){var e=this.playersData[this.currentPlayerIndex].player;e.type===m.TYPES.COMPUTER&&setTimeout((function(){e.play()}),1e3)},isComputerCurrentPlayer:function(){return this.playersData[this.currentPlayerIndex].player.type===m.TYPES.COMPUTER}}}Object.freeze(a),m.TYPES={COMPUTER:"C",HUMAN:"H"},Object.freeze(m),Object.freeze(m.prototype);var E=g(),O=!1;function P(e){if(!O){O=!0;var r=0===E.currentPlayerIndex?1:0;E.playersData[r].player.gameBoard.receiveAttack(e),O=!1}}function S(){E.renderPlayerUI(0===E.currentPlayerIndex?1:0),E.playIfComputerTurn()}function T(){E.switchCurrentPlayer(),E.renderAllPlayersUI(),E.playIfComputerTurn()}function A(){a.emit(a.GAME_OVER)}var w=[e("h1","head","Odin Battleship"),e("div","game-container")],I=w[0],j=w[1],C=function(e){return{gameContainer:e,startNewGame:function(){a.remove(a.ATTACK,P),a.remove(a.HIT,S),a.remove(a.MISS,T),a.remove(a.LOSS,A),E=g(),v(this.gameContainer.children).forEach((function(e){return e.remove()})),E.renderAllPlayersUI(this.gameContainer),a.add(a.ATTACK,P),a.add(a.HIT,S),a.add(a.MISS,T),a.add(a.LOSS,A)},isComputerWon:function(){return E.isComputerCurrentPlayer()},endCurrentGame:function(){E.allPlayersDisabled=!0,E.renderAllPlayersUI()}}}(j);a.add(a.GAME_OVER,(function(){C.endCurrentGame();var r=C.isComputerWon()?"Game Over!":"You Win!",t=[e("dialog","game-over"),e("h2","message",r),e("p","question","Do want to play again?"),e("button","cancel-btn","Cancel",["type","button"]),e("button","play-again-btn","Play Again",["type","button"])],n=t[0],o=t[1],a=t[2],i=t[3],l=t[4];n.addEventListener("close",(function(){return document.body.removeChild(n)})),i.addEventListener("click",(function(){return n.close()})),l.addEventListener("click",(function(){C.startNewGame(),n.close()})),n.append(o,a,i,l),document.body.append(n),n.showModal()})),C.startNewGame(),document.body.append(I,j)}();
//# sourceMappingURL=odin-battleship.5590af45f0ba7d65f688.bundle.js.map