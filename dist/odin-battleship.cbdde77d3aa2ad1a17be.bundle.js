!function(){"use strict";function e(e,t,r){for(var n=arguments.length,o=new Array(n>3?n-3:0),a=3;a<n;a++)o[a-3]=arguments[a];if("string"!=typeof e)throw TypeError("Missing 'tagName' of type 'string'!");var i=document.createElement(e);if(t&&(i.className=t),r&&(i.textContent=r),1===o.length&&Array.isArray(o[0])&&Array.isArray(o[0][0])&&(o=o.flat(1)),o.length>0)for(var c=0;c<o.length;c++){if(!Array.isArray(o[c])||2!==o[c].length||!o[c][0]||"string"!=typeof o[c][0])throw TypeError("A given attribute in '...attrs' must be in the form of [string, string]");(o[c][1]||0===o[c][1]||""===o[c][1])&&i.setAttribute(o[c][0],o[c][1])}return i}var t={};function r(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];if("string"!=typeof e||!n.every((function(e){return"function"==typeof e}))){var a="".concat(e).concat(n.length>0?", "+n.toString().replace(/(?:\[|\])/,""):"");throw TypeError("Expect event name of type 'string' and at least 1 callback! Given: '".concat(a,"'"))}var i;t[e]?(i=t[e]).push.apply(i,n):t[e]=n}function n(e,r){if("string"!=typeof e||"function"!=typeof r)throw TypeError("Expect (eventName: string) & (callback: function)! Given: '".concat(e,", ").concat(r,"'"));t[e]&&(t[e]=t[e].filter((function(e){return e!==r})))}function o(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];if("string"!=typeof e)throw TypeError("Expect at least 1 argument of type 'string'! Given: '".concat(e,"'"));t[e]&&t[e].forEach((function(e){e.apply(void 0,n)}))}Object.freeze(r),Object.freeze(r.prototype),Object.freeze(n),Object.freeze(n.prototype),Object.freeze(o),Object.freeze(o.prototype);var a={ATTACK:"Fire",HIT:"Boom",MISS:"Oops",LOSS:"Meh",GAME_OVER:"Bye",SHIP_MOVED:"voo",add:r,remove:n,emit:o};function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function c(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?c(Object(r),!0).forEach((function(t){var n,o,a,c;n=e,o=t,a=r[t],c=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o),(o="symbol"==i(c)?c:String(c))in n?Object.defineProperty(n,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[o]=a})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e){if(!Number.isInteger(e)||e<2||e>5)throw TypeError("Expect 1 argument (length) of type 'number'; 1 < length < 6! given '".concat(e,"'"));var t=0,r=!1,n=function(){r||(t++,r=t>=e)},o=function(){return r},a={length:e,hits:t,hit:n,isSunk:o};Object.setPrototypeOf(a,u.prototype);var i={configurable:!1,enumerable:!0},c=l(l({},i),{},{writable:!1});return Object.defineProperties(a,{constructor:l(l({},c),{},{enumerable:!1,value:u}),length:l(l({},i),{},{get:function(){return e}}),hits:l(l({},i),{},{get:function(){return t}}),hit:l(l({},c),{},{value:n}),isSunk:l(l({},c),{},{value:o})}),a}function f(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||s(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,c=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}Object.freeze(a);var y=[],h=[];function v(e){for(var t=10,r=[],n=0;n<t;n++){r[n]=[];for(var o=0;o<t;o++)r[n][o]={ship:null,attacked:!1,missed:!1}}var i=[],c=function(e){return Math.floor(Math.random()*e)},l=function(e){var t=p(e,2),n=t[0],o=t[1];return null===r[n][o].ship},s=function(e,t,r){for(var n=[],o=t,a=0;a<e.length;a++){if(!l(o))return[];n.push(f(o)),o[r]++}return n},d=!1,m=function(e){for(var n=[],o=0;0===n.length&&o<100;){o++;var a=c(2),l=0===a?1:0,u=Array(2);u[a]=c(t-e.length),u[l]=c(t),n=s(e,u,a)}d=o>=100,n.forEach((function(t){var n=p(t,2),o=n[0],a=n[1];r[o][a].ship=e})),i.push(f(n))},b=[u(2),u(3),u(3),u(4),u(5)];if(!e&&Array.isArray(y)&&y.length===t)b.splice.apply(b,[0,b.length].concat(h)),r.forEach((function(e,t){e.forEach((function(e,r){if(e.ship=y[t][r].ship,e.ship){var n=b.findIndex((function(t){return t===e.ship}));Array.isArray(i[n])||(i[n]=[]),i[n].push([t,r])}}))})),i.forEach((function(e,t){var n=u(r[e[0][0]][e[0][1]].ship.length);b[t]=n,e.forEach((function(e){var n=p(e,2),o=n[0],a=n[1];r[o][a].ship=b[t]}))}));else do{b.forEach(m)}while(d);var g=function(e,n){if(e>=i.length)throw TypeError("Invalid ship index! Ships count = ".concat(i.length,". Given index = ").concat(e,"."));for(var o,c=[],l=i[e],u=i.filter((function(t,r){return r!==e})),f=function(){var e=l[s],r=[e[0]+n[0],e[1]+n[1]];if(r.some((function(e){return e<0}))||r.some((function(e){return e>=t}))||u.some((function(e){return e.some((function(e){return"".concat(e)==="".concat(r)}))})))return{v:!1};c.push(r)},s=0;s<l.length;s++)if(o=f())return o.v;l.forEach((function(e){var t=p(e,2),n=t[0],o=t[1];r[n][o].ship=null})),i[e]=c,i[e].forEach((function(t){var n=p(t,2),o=n[0],a=n[1];r[o][a].ship=b[e]})),r.forEach((function(e){e.attacked=!1,e.missed=!1})),a.emit(a.SHIP_MOVED);for(var d=0;d<t;d++){y[d]=[];for(var v=0;v<t;v++)y[d][v]={ship:r[d][v].ship,attacked:r[d][v].attacked,missed:r[d][v].missed}}return h.splice.apply(h,[0,h.length].concat(b)),!0},E={board:r,ships:b,shipsAreas:i,receiveAttack:function(e){var t=p(e,2),n=t[0],o=t[1];if(n<0||o<0||n>9||o>9)throw TypeError("Invalid coordinates! It should be in the range from '[0, 0]' to '[".concat(9,", ").concat(9,"]', the given is '[").concat(o,", ").concat(o,"]'."));var i=r[n][o];i.ship&&!i.attacked?(i.ship.hit(),i.attacked=!0,a.emit(a.HIT,[n,o])):i.ship||i.missed||(i.missed=!0,a.emit(a.MISS,[n,o])),b.every((function(e){return e.isSunk()}))&&a.emit(a.LOSS)},moveShipUp:function(e){return g(e,[-1,0])},moveShipDown:function(e){return g(e,[1,0])},moveShipLeft:function(e){return g(e,[0,-1])},moveShipRight:function(e){return g(e,[0,1])}};return Object.setPrototypeOf(E,v.prototype),Object.defineProperty(E,"constructor",{value:v,writable:!1,configurable:!1,enumerable:!1}),Object.freeze(E),E}function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,i,c=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(c.push(n.value),c.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw o}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function g(e){if(void 0!==e&&e!==g.TYPES.COMPUTER&&e!==g.TYPES.HUMAN)throw TypeError("Invalid type! Only '".concat(g.TYPES.COMPUTER,"' & '").concat(g.TYPES.HUMAN,"' are the valid types. Given: '").concat(e,"'"));var t=void 0===e?g.TYPES.COMPUTER:e,r={type:t,gameBoard:v(t===g.TYPES.COMPUTER)};if(r.type===g.TYPES.COMPUTER){for(var n,o,i=r.gameBoard.board.length,c=null!==(n=null===(o=r.gameBoard.board[0])||void 0===o?void 0:o.length)&&void 0!==n?n:0,l=null,u=[],f=0;f<i;f++)for(var p=0;p<c;p++)u.push([f,p]);var s=null,d=null,y=!1;a.add(a.MISS,(function(){y&&(s=null,y=!1)})),a.add(a.HIT,(function(){var e,t;y&&(e=[],t=[],[[-1,0],[0,1],[1,0],[0,-1]].forEach((function(r,n){var o,a=[l[0]+r[0],l[1]+r[1]];(o=a)[0]>=0&&o[1]>=0&&o[0]<i&&o[1]<c&&u.some((function(e){var t=m(e,2),r=t[0],n=t[1];return r===o[0]&&n===o[1]}))?(e.push(a),t.push(n)):e.push(null)})),t.length>0?(null!==s&&t.includes(s)||(s=t[Math.floor(Math.random()*t.length)]),d=e[s]):(s=null,d=null),y=!1)})),r.play=function(){if(u.length>0){if(null===d){var e=Math.floor(Math.random()*u.length);l=u[e],u.splice(e,1)}else l=d,d=null,u.splice(u.findIndex((function(e){var t=m(e,2),r=t[0],n=t[1];return l[0]===r&&l[1]===n})),1);y=!0,a.emit(a.ATTACK,l)}else y=!1,a.emit(a.GAME_OVER)}}return Object.setPrototypeOf(r,g.prototype),Object.defineProperty(r,"constructor",{value:g,writable:!1,enumerable:!1,configurable:!1}),Object.freeze(r),r}function E(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function P(){return{playersData:[{name:"user",player:g(g.TYPES.HUMAN),playerUI:e("div","first-player")},{name:"computer",player:g(g.TYPES.COMPUTER),playerUI:e("div","second-player")}],currentPlayerIndex:0,allPlayersDisabled:!1,gameStarted:!1,switchCurrentPlayer:function(){this.currentPlayerIndex=(this.currentPlayerIndex+1)%2},renderPlayerInfo:function(t){var r=this.playersData[t],n=E(r.playerUI.children);n.forEach((function(e){return e.remove()})),r.playerUI.append(function(t,r,n){if("string"!=typeof t)throw TypeError("Invalid 'name' type; expected: 'string', given: '".concat(t,"'"));var o,a,i,c=e("div","".concat(t,"-info")),l=(o=t.replace("-"," "),i=(a=String(o)).length>1?a.slice(1):"",a.charAt(0).toLocaleUpperCase()+i),u=e("h3","player-name","".concat(l));if(c.append(u),n&&r===g.TYPES.HUMAN){var f=e("div","ship-nav"),p=e("div","select-container"),s=e("select","select-ship",null,["name","select-ship"]);n.shipsAreas.forEach((function(t,r){s.appendChild(e("option","ship-option","".padStart(t.length,"◼"),["value",r]))}));var d=[e("button","move-up-btn","Up",["type","button"]),e("button","move-down-btn","Down",["type","button"]),e("button","move-left-btn","Left",["type","button"]),e("button","move-right-btn","Right",["type","button"])],y=d[0],h=d[1],v=d[2],m=d[3],b=function(e){if(s.value){var t=Number(s.value);Number.isInteger(t)&&n[e](t)}};y.addEventListener("click",(function(){return b("moveShipUp")})),h.addEventListener("click",(function(){return b("moveShipDown")})),v.addEventListener("click",(function(){return b("moveShipLeft")})),m.addEventListener("click",(function(){return b("moveShipRight")})),p.addEventListener("pointerdown",(function(){p.classList.add("open")})),document.body.addEventListener("pointerup",(function(){p.classList.contains("open")&&p.classList.remove("open")})),p.appendChild(s),f.append(p,y,h,v,m),c.appendChild(f)}return c}(r.name,r.player.type,this.gameStarted?null:r.player.gameBoard)),n.length>1&&r.playerUI.appendChild(n[1])},renderPlayerBoard:function(t){var r=this.playersData[t],n=t===this.currentPlayerIndex,o=(this.allPlayersDisabled||n)&&this.gameStarted,i=r.player.type===g.TYPES.COMPUTER&&!n&&!o;E(r.playerUI.children).length>1&&r.playerUI.removeChild(r.playerUI.lastChild),r.playerUI.appendChild(function(t,r,n,o){if([t,r,n].forEach((function(e){if(void 0===e)throw TypeError("'Board' is called with an invalid number of arguments!")})),!(t instanceof v))throw TypeError("'Board' is called with invalid 'playerGameBoard'! Given '".concat(t,"'."));if("boolean"!=typeof r||"boolean"!=typeof n)throw TypeError("'Board' expects 'hidden' & 'disabled' of type 'boolean'! Given '".concat(r," & ").concat(n,"'."));var i=e("div","board-container"+(n?" disabled":"")),c=0;return t.board.forEach((function(t,n){c=t.length,t.forEach((function(t,c){var l="board-cell";t.ship?(r||(l+=" ship"),t.ship.isSunk()?l+=" sunk":t.attacked&&(l+=" attacked")):t.missed&&(l+=" missed");var u=e("div",l);o&&u.addEventListener("click",(function(){a.emit(a.ATTACK,[n,c])})),i.appendChild(u)}))})),i.style.display="grid",i.style.gridTemplateColumns="repeat(".concat(c,", 1fr)"),i.style.gridTemplateRows="repeat(".concat(c,", auto)"),i}(r.player.gameBoard,r.player.type===g.TYPES.COMPUTER,o,i))},renderPlayerUI:function(e,t){var r=this.playersData[e];E(r.playerUI.children).forEach((function(e){return e.remove()})),this.renderPlayerInfo(e),this.renderPlayerBoard(e),t&&t.append(r.playerUI)},renderAllPlayersUI:function(e){for(var t=0;t<this.playersData.length;t++)this.renderPlayerUI(t,e)},playIfComputerTurn:function(){var e=this.playersData[this.currentPlayerIndex].player;e.type===g.TYPES.COMPUTER&&setTimeout((function(){e.play()}),1e3)},isComputerCurrentPlayer:function(){return this.playersData[this.currentPlayerIndex].player.type===g.TYPES.COMPUTER}}}g.TYPES={COMPUTER:"C",HUMAN:"H"},Object.freeze(g),Object.freeze(g.prototype);var O=P(),A=!1;function I(e){if(!A){A=!0;var t=0===O.currentPlayerIndex?1:0;O.playersData[t].player.gameBoard.receiveAttack(e),A=!1}}function T(){O.renderPlayerUI(0===O.currentPlayerIndex?1:0),O.playIfComputerTurn()}function w(){O.switchCurrentPlayer(),O.renderAllPlayersUI(),O.playIfComputerTurn()}function C(){a.emit(a.GAME_OVER)}function j(){O.gameStarted?O.renderAllPlayersUI():O.renderPlayerBoard(0)}var U=[e("div","head-container"),e("h1","head","Odin Battleship"),e("button","start-btn control-btn","Start",["type","button"]),e("button","reset-btn control-btn","Reset",["type","button"]),e("div","game-container")],M=U[0],k=U[1],D=U[2],L=U[3],x=U[4],G=function(e){return{gameContainer:e,initiateNewGame:function(){a.remove(a.SHIP_MOVED,j),a.remove(a.ATTACK,I),a.remove(a.HIT,T),a.remove(a.MISS,w),a.remove(a.LOSS,C),O=P(),a.add(a.SHIP_MOVED,j),a.add(a.ATTACK,I),a.add(a.HIT,T),a.add(a.MISS,w),a.add(a.LOSS,C),E(this.gameContainer.children).forEach((function(e){return e.remove()})),O.renderPlayerUI(0,this.gameContainer)},startGame:function(){O.gameStarted=!0,E(this.gameContainer.children).forEach((function(e){return e.remove()})),O.renderAllPlayersUI(this.gameContainer)},isComputerWon:function(){return O.isComputerCurrentPlayer()},endCurrentGame:function(){O.gameStarted=!1,O.allPlayersDisabled=!0,O.renderAllPlayersUI()}}}(x),R=!1;D.addEventListener("click",(function(){G.startGame(),M.removeChild(D),M.appendChild(L)})),L.addEventListener("click",(function(){G.initiateNewGame(),M.removeChild(L),M.appendChild(D),R=!1})),a.add(a.GAME_OVER,(function(){if(!R){R=!0,G.endCurrentGame();var t=G.isComputerWon()?"Game Over!":"You Win!",r=[e("dialog","game-over"),e("h2","message",t),e("p","question","Do want to play again?"),e("button","cancel-btn","Cancel",["type","button"]),e("button","play-again-btn","Play Again",["type","button"])],n=r[0],o=r[1],a=r[2],i=r[3],c=r[4];n.addEventListener("close",(function(){return document.body.removeChild(n)})),i.addEventListener("click",(function(){return n.close()})),c.addEventListener("click",(function(){G.initiateNewGame(),n.close(),L.click()})),n.append(o,a,i,c),document.body.append(n),n.showModal()}})),G.initiateNewGame(),M.append(k,D),document.body.append(M,x)}();
//# sourceMappingURL=odin-battleship.cbdde77d3aa2ad1a17be.bundle.js.map